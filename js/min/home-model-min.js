function loginCallback(){FB.getLoginStatus(function(e){"connected"===e.status?($("#alertText").text("Connected"),$("#alertBody").hide(),$("#alert").delay(1500).fadeOut(2e3),$("#splash").fadeOut(2e3),displayMe()):($("#alert").fadeIn(2e3),$("#splash").fadeIn(1e3),$("#alertText").text("Please Login"),$("#alertBody").show())})}function displayHeader(){FB.api("/"+pageId,"get",function(e){e&&!e.error&&($("#bg").css("background-image",'url("'+e.cover.source+'")'),$("#title").text(e.name))})}function displayMe(){FB.api("/me?fields=name","get",function(e){if(e&&!e.error){var o=e.name;FB.api("/me/picture?redirect=false&type=square","get",function(e){e&&!e.error&&$("#user").html('<figure><img src="'+e.data.url+'"><figcaption>'+o+"</figcaption></figure>")})}})}function getAlbums(){FB.api("/"+pageId+"/albums",function(e){if(e&&!e.error)for(var o=e.data.length,i=0,a=0;a<e.data.length;a++)FB.api("/"+e.data[a].id+"/photos",function(e){for(var a=e.data,n=0;n<a.length;n++)for(var t=0;t<a[n].images.length;t++)if(320===a[n].images[t].height){var s=a[n].name;void 0===s&&(s="");var l=a[n].likes;l=void 0===l?0:a[n].likes.data.length,img.push({id:a[n].id,source:a[n].images[t].source,url:a[n].source,title:s,likes:l})}i++,i===o&&(displayPhotos(img),likeBtn(img))})})}function askPermissionToLike(e,o){return function(i){console.log("likeBtn pressed"),FB.api("/me/permissions",function(i){for(var a=!1,n=0;n<i.data.length;n++)"publish_actions"===i.data[n].permission&&"granted"===i.data[n].status&&(console.log("User has required permissions"),like(e,o),a=!0);a||(console.log("User does not have required permissions"),console.log("Asking for additional permissions..."),FB.login(function(i){i.authResponse?(like(e,o),console.log("Got access token")):console.log("User canceled login or did not authorize the app.")},{scope:"publish_actions"}))})}}function like(e,o){FB.api("/me?fields=id",function(i){var a=i.id;console.log("Grabbing user ID: "+a),FB.api(e+"/likes?fields=id",function(i){var n=!1;console.log("Checking if previously liked...");for(var t=0;t<i.data.length;t++)i.data[t].id===a&&(console.log("alert user"),alert("I know you like this photo, but unfortunately Facebook only allows you to like it once."),n=!0);n||(console.log("Liking..."),FB.api("/"+e+"/likes","POST",function(e){if(e.success===!0){console.log("Like was successful");var i=img[o].likes;i++,$("#"+o).next().text(i)}else console.log("An error occurred: "+e.error.message),console.log(e)}))})})}var pageId="815157038515764",appId="1480115835608916",img=[];$(document).ready(function(){$.ajaxSetup({cache:!0}),$.getScript("//connect.facebook.net/en_UK/all.js",function(){FB.init({appId:appId,xfbml:!0,version:"v2.1"}),loginCallback(),displayHeader(),getAlbums()})});