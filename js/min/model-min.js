function loginCallback(){FB.getLoginStatus(function(e){$(".header").show(),"connected"===e.status?($("#alertText").text("Connected"),$("#alertBody").hide(),$(".alert").delay(1500).fadeOut(2e3),$(".splash").fadeOut(2e3),displayPage(),getAlbums()):($(".alert").fadeIn(2e3),$(".splash").fadeIn(2e3),$("#alertText").text("Please Login"),$("#alertBody").show())})}function displayPage(){FB.api("/"+pageId,"get",function(e){e&&!e.error&&($(".bg").css("background-image",'url("'+e.cover.source+'")'),$("#title").text(e.name),$("#description").text(e.description))})}function getAlbums(){FB.api("/"+pageId+"/albums",function(e){if(e&&!e.error)for(var t=e.data.length,i=0,o=0;o<e.data.length;o++)FB.api("/"+e.data[o].id+"/photos",function(e){for(var o=e.data,s=0;s<o.length;s++)for(var l=0;l<o[s].images.length;l++)if(320===o[s].images[l].height){var a=o[s].name;void 0===a&&(a="");var n=o[s].likes;n=void 0===n?0:o[s].likes.data.length,img.push({id:o[s].id,source:o[s].images[l].source,url:o[s].source,title:a,likes:n})}i++,i===t&&(displayPhotos(img),likeBtn(img))})})}function displayPhotos(e){var t="";console.log(e);for(var i=0;i<e.length;i++)t+='<figure class="cell"><a href="'+e[i].url+'" data-lightbox="gallary" data-title="'+e[i].title+'"><img src="'+e[i].source+'" alt="'+e[i].title+'"></a><figcaption>'+e[i].title+'<br><img id="'+i+'" src="img/fbl.png" title="Like"><span>'+e[i].likes+"</span></figcaption></figure>";$(".gallery").html(t)}function likeBtn(e){for(var t=0;t<e.length;t++){var i=e[t].id;$("#"+t).click(askPermissionToLike(i,t))}}function askPermissionToLike(e,t){return function(i){console.log("likeBtn pressed"),FB.api("/me/permissions",function(i){for(var o=!1,s=0;s<i.data.length;s++)"publish_actions"===i.data[s].permission&&"granted"===i.data[s].status&&(console.log("User has required permissions"),like(e,t),o=!0);o||(console.log("User does not have required permissions"),console.log("Asking for additional permissions..."),FB.login(function(i){i.authResponse?(like(e,t),console.log("Got access token")):console.log("User canceled login or did not authorize the app.")},{scope:"publish_actions"}))})}}function like(e,t){FB.api("/me?fields=id",function(i){var o=i.id;console.log("Grabbing user ID: "+o),FB.api(e+"/likes?fields=id",function(i){var s=!1;console.log("Checking if previously liked...");for(var l=0;l<i.data.length;l++)i.data[l].id===o&&(console.log("alert user"),alert("I know you like this photo, but unfortunately Facebook only allows you to like it once."),s=!0);s||(console.log("Liking..."),FB.api("/"+e+"/likes","POST",function(e){if(e.success===!0){console.log("Like was successful");var i=img[t].likes;i++,$("#"+t).next().text(i)}else console.log("An error occurred: "+e.error.message),console.log(e)}))})})}function search(){searchImg=[];for(var e=$("#searchTxt").val().toLowerCase().replace(/\s/g,""),t=0;t<img.length;t++)-1!==img[t].title.toLowerCase().replace(/\s/g,"").indexOf(e)&&searchImg.push(img[t]);displayPhotos(searchImg),orderBy(document.getElementById("sort")),console.log(document.getElementById("sort"))}function orderBy(e){var t=[];switch(t=searchImg.length>0?searchImg:img,e.selectedIndex){case 1:displayPhotos(t.sort(function(e,t){return e.likes-t.likes!==0?e.likes-t.likes:e.title<t.title?-1:e.title>t.title?1:void 0}));break;case 2:displayPhotos(t.sort(function(e,t){return t.likes-e.likes!==0?t.likes-e.likes:e.title<t.title?-1:e.title>t.title?1:void 0}));break;case 3:displayPhotos(t.sort(function(e,t){return e.title<t.title?-1:e.title>t.title?1:e.title===t.title?t.likes-e.likes:void 0}));break;case 4:displayPhotos(t.sort(function(e,t){return t.title<e.title?-1:t.title>e.title?1:t.title===e.title?e.likes-t.likes:void 0}))}}var pageId="815157038515764",appId="1480115835608916",img=[];$(document).ready(function(){$.ajaxSetup({cache:!0}),$.getScript("//connect.facebook.net/en_UK/all.js",function(){FB.init({appId:appId,xfbml:!0,version:"v2.1"}),loginCallback()})}),$("input").keypress(function(e){13===e.which&&search()});var searchImg=[];
//# sourceMappingURL=./model-min.js.map